<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>BIS Teacher Portal</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>

:root{
--chocolate:#3E2723;
--gold:#FFB300;
--bg:#fcfaf5;
}

*{
margin:0;
padding:0;
box-sizing:border-box;
font-family:'Segoe UI';
}

body{
background:var(--bg);
}

/* HEADER */

.header{
background:linear-gradient(135deg,#3E2723,#5D4037);
color:white;
padding:30px 20px 90px;
border-radius:0 0 40px 40px;
}

.topbar{
display:flex;
justify-content:space-between;
align-items:center;
}

.avatar{
width:55px;
height:55px;
border-radius:50%;
background:#FFB300;
display:flex;
align-items:center;
justify-content:center;
font-weight:bold;
font-size:20px;
color:#3E2723;
}

.settings{
font-size:20px;
cursor:pointer;
color:#FFB300;
}

/* STATS */

.stats{
display:flex;
gap:12px;
padding:0 20px;
margin-top:-55px;
}

.stat{
flex:1;
background:white;
padding:20px;
border-radius:18px;
text-align:center;
box-shadow:0 10px 18px rgba(0,0,0,.08);
}

/* NOTICE */

.notice{
margin:20px;
background:white;
padding:18px;
border-radius:18px;
box-shadow:0 6px 14px rgba(0,0,0,.05);
border-left:6px solid var(--gold);
}

/* QUICK BUTTONS */

.quick{
display:flex;
gap:10px;
padding:0 20px;
margin-bottom:10px;
}

.quick button{
flex:1;
padding:12px;
border:none;
border-radius:12px;
background:white;
box-shadow:0 4px 10px rgba(0,0,0,.05);
cursor:pointer;
font-weight:600;
}

/* SEARCH */

.search{
padding:10px 20px;
}

.search input{
width:100%;
padding:12px;
border-radius:12px;
border:1px solid #ddd;
}

/* RECENT */

.section-title{
padding:0 20px;
font-weight:bold;
color:#3E2723;
}

.recent{
padding:10px 20px 80px;
}

.assignment{
background:white;
padding:16px;
border-radius:14px;
margin-top:10px;
box-shadow:0 4px 10px rgba(0,0,0,.05);
position:relative;
}

.badge{
position:absolute;
top:10px;
right:10px;
background:var(--gold);
padding:4px 8px;
border-radius:6px;
font-size:11px;
font-weight:bold;
}

.assignment-actions{
margin-top:10px;
display:flex;
gap:10px;
}

.assignment-actions button{
flex:1;
padding:7px;
border:none;
border-radius:8px;
cursor:pointer;
font-size:12px;
}

.edit{
background:#e3f2fd;
}

.delete{
background:#ffebee;
color:#c62828;
}

.logout{
margin:20px;
width:calc(100% - 40px);
padding:14px;
border:none;
border-radius:12px;
background:#ffebee;
color:#c62828;
font-weight:bold;
cursor:pointer;
}

/* FLOAT BUTTON */

.float-btn{
position:fixed;
bottom:25px;
right:25px;
width:65px;
height:65px;
border-radius:50%;
border:none;
background:var(--gold);
font-size:26px;
cursor:pointer;
box-shadow:0 10px 20px rgba(0,0,0,.25);
}

/* MODAL */

.modal{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,.7);
display:none;
justify-content:center;
align-items:center;
padding:20px;
}

.modal-box{
background:white;
width:100%;
max-width:380px;
padding:25px;
border-radius:20px;
}

input,textarea,select{
width:100%;
padding:11px;
margin-top:8px;
margin-bottom:14px;
border-radius:10px;
border:1px solid #ddd;
}

.save{
width:100%;
padding:13px;
border:none;
border-radius:12px;
background:var(--gold);
font-weight:bold;
cursor:pointer;
}

</style>
</head>

<body>

<div class="header">
<div class="topbar">

<div>
<h2 id="teacherName">Welcome</h2>
<p id="teacherID"></p>
</div>

<div class="avatar" id="avatar"></div>

<i class="fas fa-cog settings"></i>

</div>
</div>


<!-- STATS -->
<div class="stats">

<div class="stat">
<i class="fas fa-book"></i>
<h3 id="assignmentCount">0</h3>
<small>Your Assignments</small>
</div>

<div class="stat">
<i class="fas fa-user-graduate"></i>
<h3 id="studentCount">0</h3>
<small>Students</small>
</div>

<div class="stat">
<i class="fas fa-calendar"></i>
<h3 id="today"></h3>
<small>Today</small>
</div>

</div>


<div class="notice">
<b>Reminder</b>
<p>Upload CA scores before the grading deadline.</p>
</div>


<!-- QUICK NAV -->
<div class="quick">
<button onclick="location.href='my_students.html'">
<i class="fas fa-users"></i> Students
</button>

<button onclick="location.href='upload_results.html'">
<i class="fas fa-chart-line"></i> Results
</button>
</div>


<!-- SEARCH -->
<div class="search">
<input placeholder="Search assignments..." onkeyup="searchAssignments(this.value)">
</div>


<div class="section-title">
Your Assignments
</div>

<div class="recent" id="recentList"></div>

<button class="logout" onclick="logout()">Logout</button>


<button class="float-btn" onclick="toggleModal(true)">
<i class="fas fa-plus"></i>
</button>



<!-- MODAL -->
<div class="modal" id="assignmentModal">
<div class="modal-box">

<h3>Post Assignment</h3>

<input id="title" placeholder="Assignment title">

<select id="grade">
<option>JSS 1</option>
<option>JSS 2</option>
<option>JSS 3</option>
<option>SSS 1</option>
<option>SSS 2</option>
<option>SSS 3</option>
</select>

<textarea id="desc" placeholder="Instructions"></textarea>

<button class="save" onclick="saveAssignment()">POST</button>

<br><br>

<button onclick="toggleModal(false)" style="background:none;border:none;color:gray;">
Cancel
</button>

</div>
</div>



<script>

let ALL_ASSIGNMENTS = [];

window.onload = function(){

const user = JSON.parse(localStorage.getItem('currentUser'));

if(!user){
location.href="index.html";
return;
}

document.getElementById("teacherName").innerText =
"Welcome, " + user.fullName;

document.getElementById("teacherID").innerText =
"ID: " + user.username;


// Better avatar
const names = user.fullName.split(" ");
document.getElementById("avatar").innerText =
(names[0][0] + (names[1]?.[0] || "")).toUpperCase();


// Load assignments
let assignments =
JSON.parse(localStorage.getItem('bis_assignments')) || [];

// Only THIS teacher's assignments
ALL_ASSIGNMENTS =
assignments.filter(a => a.teacher === user.fullName);


// Stats
document.getElementById("assignmentCount").innerText =
ALL_ASSIGNMENTS.length;

const students =
JSON.parse(localStorage.getItem('bis_users')) || [];

document.getElementById("studentCount").innerText =
students.filter(u=>u.role==="student").length;

document.getElementById("today").innerText =
new Date().toLocaleDateString();


renderAssignments(ALL_ASSIGNMENTS);

};



function renderAssignments(list){

if(list.length === 0){
document.getElementById("recentList").innerHTML =
"<p style='opacity:.6'>No assignments yet.</p>";
return;
}

document.getElementById("recentList").innerHTML =
list.reverse().map(a=>`
<div class="assignment">

<div class="badge">NEW</div>

<b>${a.title}</b>
<p>${a.grade}</p>
<small>${a.date}</small>

<div class="assignment-actions">

<button class="edit"
onclick="editAssignment(${a.id})">
Edit
</button>

<button class="delete"
onclick="deleteAssignment(${a.id})">
Delete
</button>

</div>

</div>
`).join("");

}



function searchAssignments(text){

const filtered = ALL_ASSIGNMENTS.filter(a =>
a.title.toLowerCase().includes(text.toLowerCase())
);

renderAssignments(filtered);

}



function deleteAssignment(id){

if(!confirm("Delete this assignment?")) return;

let assignments =
JSON.parse(localStorage.getItem('bis_assignments')) || [];

assignments =
assignments.filter(a => a.id !== id);

localStorage.setItem('bis_assignments', JSON.stringify(assignments));

location.reload();

}



function editAssignment(id){

let assignments =
JSON.parse(localStorage.getItem('bis_assignments')) || [];

const a = assignments.find(x=>x.id===id);

document.getElementById("title").value = a.title;
document.getElementById("grade").value = a.grade;
document.getElementById("desc").value = a.description;

deleteAssignment(id);

toggleModal(true);

}



function toggleModal(show){
document.getElementById("assignmentModal").style.display =
show ? "flex":"none";
}



function saveAssignment(){

const title = document.getElementById("title").value;
const grade = document.getElementById("grade").value;
const desc = document.getElementById("desc").value;

if(!title || !desc){
alert("Fill all fields");
return;
}

const user = JSON.parse(localStorage.getItem('currentUser'));

let assignments =
JSON.parse(localStorage.getItem('bis_assignments')) || [];

assignments.push({
id:Date.now(),
title,
grade,
description:desc,
teacher:user.fullName,
date:new Date().toLocaleDateString(),
createdAt:Date.now()
});

localStorage.setItem('bis_assignments', JSON.stringify(assignments));

toggleModal(false);

location.reload();
}



function logout(){

if(confirm("Logout now?")){
localStorage.removeItem('currentUser');
location.href="index.html";
}

}

</script>

</body>
</html>